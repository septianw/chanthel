var Api = require('apiclient');
//var async = require('async');
var seed = require('./seed.json');
var common = require('bcommon');


function Solr(data) {
  // console.log(data);
  seed.base.protocol = data.protocol;
  seed.base.hostname = data.hostname;
  seed.base.port = data.port;
  // console.log(seed);
  var rest = new Api(seed);
  var self = this; self._send = function (method, endpoint, param, callback) {
  var p = param;
    // p.opt.followAllRedirects = true;
    rest[method](endpoint, p.par, p.opt, callback);
  };
}


Solr.prototype.createCollections = function (param, callback) {
  var self = this; self._send('get', 'collections', param, callback);
};

Solr.prototype.listCollections = function (param, callback) {
  var self = this; self._send('get', 'list_collections', param, callback);
};

Solr.prototype.crawling = function (param, callback) {
  var self = this; self._send('get', 'crawling', param, callback);
};

Solr.prototype.searching = function (param, callback) {
  var self = this; self._send('get', 'searching', param, callback);
};

module.exports = Solr;
